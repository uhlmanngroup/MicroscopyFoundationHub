# ---- I/O ----
train_img_dir: /home/cfuste/data/datasets/DINO-POC/train/images
train_mask_dir: /home/cfuste/data/datasets/DINO-POC/train/masks
val_img_dir:    /home/cfuste/data/datasets/DINO-POC/test/images
val_mask_dir:   /home/cfuste/data/datasets/DINO-POC/test/masks

# results + experiment naming
experiment_id: "2025-01-01_A1_headonly_dinov2-base_lora-none_seg"
results_root: "runs"
task_type: "seg"

# ---- model ----
dino_size: base
img_size:
  mode: longest_edge
  target: 1022
  patch_multiple: 14
  rounding: floor
dataset:
  type: paired
  params:
    pair_mode: "stem"
    recursive: false
num_classes: 2

# ---- LoRA (disabled) ----
use_lora: false          # << baseline: no adapters
lora_targets: [attn.qkv, attn.proj]
lora_rank: 16
lora_alpha: 32

# ---- training ----
batch_size: 4
epochs: 40
patience: 20
lr: 0.001                # head-only can use a higher LR than LoRA
weight_decay: 0.0001
num_workers: 8
device: auto
amp: false               # keep off for stability first
save_every: 5

# ---- loss: CE + Tversky (fg) ----
loss: ce_tversky
class_weights: [1.0, 15.0]  # bump a bit for imbalance
tversky_alpha: 0.7
tversky_beta: 0.3
tversky_eps: 1.0e-6
tversky_weight: 0.6

# ---- safety ----
clip_grad_norm: 1.0

# ---- optional prior bias (see trainer patch below) ----
init_fg_prior: 0.06       # set to ~% foreground in train set; or comment out
