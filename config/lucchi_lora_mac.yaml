# Environment: Mac / local dev — Lucchi++ dataset

# Composed dataset (train/test already prepared)
# train_img_dir: "/Users/cfuste/Documents/Data/ElectronMicroscopy/composed-dinopeft/train/images"
# train_mask_dir: "/Users/cfuste/Documents/Data/ElectronMicroscopy/composed-dinopeft/train/masks"
# test_img_dir:   "/Users/cfuste/Documents/Data/ElectronMicroscopy/composed-dinopeft/test/images"
# test_mask_dir:  "/Users/cfuste/Documents/Data/ElectronMicroscopy/composed-dinopeft/test/masks"

# only Lucchi
train_img_dir: "/Users/cfuste/Documents/Data/ElectronMicroscopy/Lucchi++/Train_In"
train_mask_dir: "/Users/cfuste/Documents/Data/ElectronMicroscopy/Lucchi++/Train_Out"
test_img_dir:   "/Users/cfuste/Documents/Data/ElectronMicroscopy/Lucchi++/Test_In"
test_mask_dir:  "/Users/cfuste/Documents/Data/ElectronMicroscopy/Lucchi++/Test_Out"

# outputs
# out_dir: "/Users/cfuste/Documents/Results/DINO-PEFT/small-350-r8-dice"
out_dir: "/Users/cfuste/Documents/Results/DINO-LoRA/small-350-r8-dice-ONLYlucchi"

# ---- model / backbone ----
dino_size: small
img_size: [350, 350]
num_classes: 2

# ---- MLflow ----
mlflow_experiment_name: Lora-Dice-R16-img518

# ---- LoRA ----
use_lora: true
lora_targets: [attn.qkv, attn.proj]
lora_rank: 8
lora_alpha: 32

# ---- training ----
batch_size: 4
epochs: 10
lr: 0.00005
weight_decay: 0.0001
num_workers: 8
device: auto
amp: true            # first run: stability check without AMP

# ---- loss (CE + Tversky on foreground) ----
loss: dice      # ce, dice, ce_tversky 
class_weights: [1.0, 15.0]    # bg, fg
tversky_alpha: 0.7
tversky_beta: 0.3
tversky_eps: 1.0e-6
tversky_weight: 0.6   # lambda: 0.6*Tversky + 0.4*CE

# ---- training safety ----
clip_grad_norm: 1.0   # global grad clip

# ---- export / viz (kept; argmax is used for CE path) ----
binarize: true
binarize_threshold: 128
